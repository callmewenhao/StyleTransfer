# é£æ ¼è¿ç§»

> è¿ç§»å­¦ä¹ å®æˆ˜â€”â€”é£æ ¼è¿ç§»ğŸ‘

## é¢„å¤‡çŸ¥è¯†

### CNN

> CNNéšç€å±‚æ•°çš„åŠ æ·±ï¼Œåœ¨ç©ºé—´å°ºåº¦çš„åƒç´ ä¿¡æ¯è¢«ä¸¢å¤±ï¼Œè€Œè¯­ä¹‰ä¿¡æ¯åœ¨å¢åŠ 

- æ¯ä¸ªå·ç§¯æ ¸æå–ä¸åŒçš„ç‰¹å¾ğŸ˜Š

- 1ä¸ªå·ç§¯æ ¸å¯¹å…¶è¾“å…¥è¿›è¡Œå·ç§¯æ“ä½œï¼Œå¾—åˆ°1ä¸ª feature map ï¼Œå…¶ä½“ç°äº†å·ç§¯æ ¸ä»è¾“å…¥ä¸­æå–çš„ç‰¹å¾

- ä¸åŒå·ç§¯æ ¸æå–ä¸åŒç‰¹å¾ï¼Œå½“å·ç§¯æ ¸æå–åˆ°å¯¹åº”ç‰¹å¾åï¼Œfeature map ä¸­å¯¹åº”çš„å€¼ç‰¹åˆ«å¤§ğŸˆ
- æµ…å±‚å·ç§¯æ ¸æå–ï¸°è¾¹ç¼˜ã€é¢œè‰²ã€æ–‘å—ç­‰åº•å±‚åƒç´ ç‰¹å¾
- ä¸­å±‚å·ç§¯æ ¸æå–ï¸°æ¡çº¹ã€çº¹è·¯ã€å½¢çŠ¶ç­‰ä¸­å±‚çº¹ç†ç‰¹å¾
- é«˜å±‚å·ç§¯æ ¸æå–ï¸°çœ¼ç›ã€è½®èƒã€æ–‡å­—ç­‰é«˜å±‚è¯­ä¹‰ç‰¹å¾
- æœ€åçš„åˆ†ç±»è¾“å‡ºå±‚è¾“å‡ºæœ€æŠ½è±¡çš„åˆ†ç±»ç»“æœ

### VGG16 & 19

> VGG16 & 19 çš„ç»“æ„å¦‚ä¸‹ï¼š

<img src="figures\VGG.png" style="zoom:100%;" />

## ç®—æ³•åŸºæœ¬æµç¨‹

<img src="figures\ST1.png" style="zoom:50%;" />

## æŸå¤±å‡½æ•°

### å†…å®¹æŸå¤±å‡½æ•°

> æ¯”è¾ƒå†…å®¹å›¾å’Œç”Ÿæˆå›¾ç»è¿‡VGG19åçš„æŸä¸ª feature map çš„å·®å¼‚

$J_{content}$ å¦‚ä¸‹ï¼š
$$
J_{content} = \frac{1}{2}||a^{[l][c]} - \alpha^{[l][g]}||^{2}
$$
å…¶ä¸­ï¼Œ$\alpha^{[l]}$ æ˜¯ç¬¬ $l$ ä¸ªä¸­é—´å±‚çš„ feature map

### é£æ ¼æŸå¤±å‡½æ•°ğŸ’¥

> Gram Matrixï¼šGramçŸ©é˜µæ˜¯ä¸¤ä¸¤å‘é‡çš„å†…ç§¯ç»„æˆï¼Œæ‰€ä»¥GramçŸ©é˜µå¯ä»¥åæ˜ å‡ºè¯¥ç»„å‘é‡ä¸­å„ä¸ªå‘é‡ä¹‹é—´çš„æŸç§å…³ç³»ã€‚

è¾“å…¥å›¾åƒçš„ feature map ä¸º [ c, h, w]ã€‚æˆ‘ä»¬ç»è¿‡ flattenï¼ˆå³æ˜¯å°†h\*wè¿›è¡Œå¹³é“ºæˆä¸€ç»´å‘é‡ï¼‰å’ŒçŸ©é˜µè½¬ç½®æ“ä½œï¼Œå¯ä»¥å˜å½¢ä¸º [ch, h\*w] å’Œ [h*w, ch] çš„çŸ©é˜µã€‚å†å¯¹ä¸¤ä¸ªä½œå†…ç§¯å¾—åˆ° Gram Matricesã€‚

<img src="figures\Gram.png" style="zoom:80%;" />

> æ¯”è¾ƒå†…å®¹å›¾å’Œç”Ÿæˆå›¾ç»è¿‡VGG19åçš„æŸä¸ª feature map çš„ Gram Matrix ä»–ä»¬è¶Šæ¥è¿‘è¶Šå¥½

ç¬¬ $l$ å±‚çš„é£æ ¼æŸå¤±å‡½æ•°ï¼š
$$
E_{l} = \frac{1}{4N^{2}_{l}M^{2}_{l}}\sum_{i, j}(G_{ij}^{l}-A_{ij}^{l})^{2}
$$
å…¶ä¸­ï¼Œ$N$ å’Œ $M$ åˆ†åˆ«æ˜¯ï¼šCã€H*W

æ€»é£æ ¼æŸå¤±å‡½æ•°ï¼š
$$
L_{style}(\vec{a}, \vec{x}) = \sum_{l=0}^{L}w_{l}E_{l}
$$
å…¶ä¸­ï¼Œ$w$ æ˜¯æ¯å±‚ loss func çš„æƒé‡

### èåˆæŸå¤±å‡½æ•°

æ€»çš„æŸå¤±å‡½æ•°ï¼š
$$
L_{total}(\vec{p}, \vec{a},\vec{x})=\alpha L_{content}(\vec{p}, \vec{x})+\beta L_{style}(\vec{a},\vec{x})
$$
å…¶ä¸­ï¼Œ$\vec{p}$ æ˜¯å†…å®¹å›¾ï¼Œ $\vec{a}$ æ˜¯é£æ ¼å›¾ï¼Œ$\vec{x}$ æ˜¯ç”Ÿæˆå›¾

## keraså®æˆ˜

https://keras.io/examples/generative/neural_style_transfer/

